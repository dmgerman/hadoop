begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/**  * Licensed to the Apache Software Foundation (ASF) under one  * or more contributor license agreements.  See the NOTICE file  * distributed with this work for additional information  * regarding copyright ownership.  The ASF licenses this file  * to you under the Apache License, Version 2.0 (the  * "License"); you may not use this file except in compliance  * with the License.  You may obtain a copy of the License at  *  *     http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
DECL|package|org.apache.hadoop.yarn.server.timelineservice.reader
package|package
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
package|;
end_package

begin_import
import|import static
name|org
operator|.
name|junit
operator|.
name|Assert
operator|.
name|assertNotNull
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|junit
operator|.
name|Assert
operator|.
name|assertNull
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|junit
operator|.
name|Assert
operator|.
name|assertTrue
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|junit
operator|.
name|Assert
operator|.
name|fail
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineCompareFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineCompareOp
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineExistsFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineFilterList
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineFilterList
operator|.
name|Operator
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineKeyValueFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelineKeyValuesFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|yarn
operator|.
name|server
operator|.
name|timelineservice
operator|.
name|reader
operator|.
name|filter
operator|.
name|TimelinePrefixFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|junit
operator|.
name|Assert
import|;
end_import

begin_import
import|import
name|org
operator|.
name|junit
operator|.
name|Test
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|collect
operator|.
name|Sets
import|;
end_import

begin_class
DECL|class|TestTimelineReaderWebServicesUtils
specifier|public
class|class
name|TestTimelineReaderWebServicesUtils
block|{
DECL|method|verifyFilterList (String expr, TimelineFilterList list, TimelineFilterList expectedList)
specifier|private
specifier|static
name|void
name|verifyFilterList
parameter_list|(
name|String
name|expr
parameter_list|,
name|TimelineFilterList
name|list
parameter_list|,
name|TimelineFilterList
name|expectedList
parameter_list|)
throws|throws
name|Exception
block|{
name|assertNotNull
argument_list|(
name|list
argument_list|)
expr_stmt|;
name|assertTrue
argument_list|(
literal|"Unexpected List received after parsing expression "
operator|+
name|expr
operator|+
literal|". Expected="
operator|+
name|expectedList
operator|+
literal|" but Actual="
operator|+
name|list
argument_list|,
name|list
operator|.
name|equals
argument_list|(
name|expectedList
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMetricFiltersParsing ()
specifier|public
name|void
name|testMetricFiltersParsing
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"(((key11 ne 234 AND key12 gt 23) AND "
operator|+
literal|"(key13 lt 34 OR key14 ge 567)) OR (key21 lt 24 OR key22 le 45))"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key11"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"key12"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key13"
argument_list|,
literal|34
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"key14"
argument_list|,
literal|567
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key21"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"key22"
argument_list|,
literal|45
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ene 234"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def gt 23"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(abc ne 234 AND def gt 23)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def gt 23 OR rst lt 24"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def gt 23 OR rst lt 24 OR xyz le 456"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def gt 23 OR rst lt 24 OR xyz le 456 AND pqr ge 2"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
comment|// Test with unnecessary spaces.
name|expr
operator|=
literal|"  abc ne   234       AND       def           gt 23 OR     rst lt "
operator|+
literal|"           24     OR xyz     le     456    AND pqr ge 2        "
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((key11 ne 234 AND key12 gt 23 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key11"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"key12"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key13"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"key14"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"key15"
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key16"
argument_list|,
literal|34
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"key17"
argument_list|,
literal|567
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key21"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"key22"
argument_list|,
literal|45
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"   (  (     (        key11      ne     234    AND key12    gt   "
operator|+
literal|"23    OR    key13    lt    24 OR key14 le 456   AND   key15   ge   2"
operator|+
literal|"   )   AND ( key16 lt 34 OR key17 ge 567 )    )     OR "
operator|+
literal|"(   key21 lt 24 OR key22 le 45 )   )    "
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key11"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_THAN
argument_list|,
literal|"key12"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key13"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"key14"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"key15"
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key16"
argument_list|,
literal|34
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|GREATER_OR_EQUAL
argument_list|,
literal|"key17"
argument_list|,
literal|567
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_THAN
argument_list|,
literal|"key21"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineCompareFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|LESS_OR_EQUAL
argument_list|,
literal|"key22"
argument_list|,
literal|45
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((key11 ne 234 AND key12 gt 23 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Improper brackers. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((key11 ne 234 AND key12 gt v3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Non Numeric value. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((key11 ne (234 AND key12 gt 3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected opening bracket. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((k)ey11 ne 234 AND key12 gt 3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected closing bracket. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((key11 rs 234 AND key12 gt 3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Improper compare op. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((key11 ne 234 PI key12 gt 3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Improper op. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((key11 ne 234 PI key12 gt 3 OR key13 lt 24 OR key14 le 456 "
operator|+
literal|"AND key15 ge 2) AND (key16 lt 34 OR key17 ge 567)) OR (key21 lt 24 "
operator|+
literal|"OR key22 le 45))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Improper op. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(key11 ne 234 AND key12 gt 3)) OR (key13 lt 24 OR key14 le 456)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unbalanced brackets. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(key11 rne 234 AND key12 gt 3) OR (key13 lt 24 OR key14 le 456)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Invalid compareop. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(key11 ne 234 AND key12 gt 3) OR (key13 lt 24 OR key14 le"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Compareop cant be parsed. Exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
literal|null
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseMetricFilters
argument_list|(
literal|"   "
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testConfigFiltersParsing ()
specifier|public
name|void
name|testConfigFiltersParsing
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"(((key11 ne 234 AND key12 eq val12) AND "
operator|+
literal|"(key13 ene val13 OR key14 eq 567)) OR (key21 eq val_21 OR key22 eq "
operator|+
literal|"val.22))"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key11"
argument_list|,
literal|"234"
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key12"
argument_list|,
literal|"val12"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key13"
argument_list|,
literal|"val13"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key14"
argument_list|,
literal|"567"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key21"
argument_list|,
literal|"val_21"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key22"
argument_list|,
literal|"val.22"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|true
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def eq 23 OR rst ene 24 OR xyz eq 456 AND pqr eq 2"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|"234"
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|,
literal|"23"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"rst"
argument_list|,
literal|"24"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|"456"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|"2"
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|true
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
comment|// Test with unnecessary spaces.
name|expr
operator|=
literal|"  abc ne   234       AND       def           eq 23 OR     rst ene "
operator|+
literal|"           24     OR xyz     eq     456    AND pqr eq 2        "
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|"234"
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|,
literal|"23"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"rst"
argument_list|,
literal|"24"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|"456"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|"2"
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|true
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc gt 234 AND def eq 23 OR rst ene 24 OR xyz eq 456 AND pqr eq 2"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Invalid compareop specified for config filters. Should be either"
operator|+
literal|" eq,ne or ene and exception should have been thrown."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
block|}
annotation|@
name|Test
DECL|method|testInfoFiltersParsing ()
specifier|public
name|void
name|testInfoFiltersParsing
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"(((key11 ne 234 AND key12 eq val12) AND "
operator|+
literal|"(key13 ene val13 OR key14 eq 567)) OR (key21 eq val_21 OR key22 eq "
operator|+
literal|"5.0))"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|AND
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key11"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key12"
argument_list|,
literal|"val12"
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"key13"
argument_list|,
literal|"val13"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key14"
argument_list|,
literal|567
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key21"
argument_list|,
literal|"val_21"
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"key22"
argument_list|,
literal|5.0
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc ne 234 AND def eq 23 OR rst ene 24 OR xyz eq 456 AND pqr eq "
operator|+
literal|"val.1234"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|"val.1234"
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
comment|// Test with unnecessary spaces.
name|expr
operator|=
literal|"  abc ne   234       AND       def           eq 23 OR     rst ene "
operator|+
literal|"           24     OR xyz     eq     456    AND pqr eq 2        "
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|,
literal|234
argument_list|,
literal|false
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|,
literal|23
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"rst"
argument_list|,
literal|24
argument_list|,
literal|true
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"xyz"
argument_list|,
literal|456
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValueFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"pqr"
argument_list|,
literal|2
argument_list|,
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abdeq"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|Assert
operator|.
name|fail
argument_list|(
literal|"Expression valuation should throw exception."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{
comment|// expected: do nothing
block|}
name|expr
operator|=
literal|"abc gt 234 AND defeq"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|Assert
operator|.
name|fail
argument_list|(
literal|"Expression valuation should throw exception."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{
comment|// expected: do nothing
block|}
name|expr
operator|=
literal|"((key11 ne 234 AND key12 eq val12) AND (key13eq OR key14 eq va14))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseKVFilters
argument_list|(
name|expr
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|Assert
operator|.
name|fail
argument_list|(
literal|"Expression valuation should throw exception."
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{
comment|// expected: do nothing
block|}
block|}
annotation|@
name|Test
DECL|method|testEventFiltersParsing ()
specifier|public
name|void
name|testEventFiltersParsing
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"abc,def"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(abc,def)"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(abc,def) OR (rst, uvx)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"rst"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"uvx"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(abc,def,uvc) OR (rst, uvx)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"uvc"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"rst"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"uvx"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((!(abc,def,uvc) OR (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb))"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"uvc"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"rst"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"uvx"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abcdefg"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"ghj"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"tyu"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"bcd"
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"tyu"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineExistsFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"uvb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"  (  (  (  !  (  abc , def  ,   uvc)   OR   (   rst  ,   uvx )  )"
operator|+
literal|"  AND   (  !  (  abcdefg ) OR  !   (  ghj,  tyu)  ) )  OR   (   ("
operator|+
literal|"   bcd   ,   tyu  )   AND   uvb  )   )"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((!(abc,def,uvc) OR (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Improper brackets. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((!(abc,def,uvc) (OR (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected opening bracket. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((!(abc,def,uvc) OR) (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected closing bracket. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((!(abc,def,uvc) PI (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Invalid op. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((!(abc,def,uvc) !OR (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu)))"
operator|+
literal|" OR ((bcd,tyu) AND uvb))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected ! char. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"abc,def,uvc) OR (rst, uvx)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected closing bracket. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"abc,def,uvc OR )rst, uvx)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected closing bracket. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"abc,def,uvc OR ,rst, uvx)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected delimiter. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"abc,def,uvc OR !  "
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unexpected not char. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(abc,def,uvc)) OR (rst, uvx)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Unbalanced brackets. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"(((! ,(abc,def,uvc) OR (rst, uvx)) AND (!(abcdefg) OR !(ghj,tyu"
operator|+
literal|"))) OR ((bcd,tyu) AND uvb))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"( should follow ! char. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
literal|null
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseEventFilters
argument_list|(
literal|"   "
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRelationFiltersParsing ()
specifier|public
name|void
name|testRelationFiltersParsing
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"type1:entity11,type2:entity21:entity22"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type2"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity21"
argument_list|,
literal|"entity22"
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(type1:entity11,type2:entity21:entity22)"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(type1:entity11,type2:entity21:entity22) OR (type3:entity31:"
operator|+
literal|"entity32:entity33,type1:entity11:entity12)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type2"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity21"
argument_list|,
literal|"entity22"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type3"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity31"
argument_list|,
literal|"entity32"
argument_list|,
literal|"entity33"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|,
literal|"entity12"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(type1:entity11,type2:entity21:entity22,type5:entity51) OR "
operator|+
literal|"(type3:entity31:entity32:entity33,type1:entity11:entity12)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type2"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity21"
argument_list|,
literal|"entity22"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type5"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity51"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type3"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity31"
argument_list|,
literal|"entity32"
argument_list|,
literal|"entity33"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|,
literal|"entity12"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((!(type1:entity11,type2:entity21:entity22,type5:entity51) OR "
operator|+
literal|"(type3:entity31:entity32:entity33,type1:entity11:entity12)) AND "
operator|+
literal|"(!(type11:entity111) OR !(type4:entity43:entity44:entity47:entity49,"
operator|+
literal|"type7:entity71))) OR ((type2:entity2,type8:entity88) AND t9:e:e1))"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type2"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity21"
argument_list|,
literal|"entity22"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type5"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity51"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type3"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity31"
argument_list|,
literal|"entity32"
argument_list|,
literal|"entity33"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type1"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity11"
argument_list|,
literal|"entity12"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type11"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity111"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type4"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity43"
argument_list|,
literal|"entity44"
argument_list|,
literal|"entity47"
argument_list|,
literal|"entity49"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"type7"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity71"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type2"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity2"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"type8"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"entity88"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
operator|new
name|TimelineKeyValuesFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"t9"
argument_list|,
name|Sets
operator|.
name|newHashSet
argument_list|(
operator|(
name|Object
operator|)
literal|"e"
argument_list|,
literal|"e1"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"   (   (  (   !   (   type1:entity11  ,  type2:entity21:entity22"
operator|+
literal|"  ,  type5:entity51  )   OR  (   type3:entity31:entity32:entity33  "
operator|+
literal|"     ,   type1:entity11:entity12)) AND (!(  type11:entity111  )  OR "
operator|+
literal|"    !   (   type4:entity43:entity44:entity47:entity49 , "
operator|+
literal|"type7:entity71  )  )  ) OR  (  (  type2:entity2 , type8:entity88) "
operator|+
literal|"AND  t9:e:e1 )    ) "
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(((!(type1 : entity11,type2:entity21:entity22,type5:entity51) OR "
operator|+
literal|"(type3:entity31:entity32:entity33,type1:entity11:entity12)) AND "
operator|+
literal|"(!(type11:entity111) OR !(type4:entity43:entity44:entity47:entity49,"
operator|+
literal|"type7:entity71))) OR ((type2:entity2,type8:entity88) AND t9:e:e1))"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseRelationFilters
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"Space not allowed in relation expression. Exception should have "
operator|+
literal|"been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
block|}
annotation|@
name|Test
DECL|method|testDataToRetrieve ()
specifier|public
name|void
name|testDataToRetrieve
parameter_list|()
throws|throws
name|Exception
block|{
name|String
name|expr
init|=
literal|"abc,def"
decl_stmt|;
name|TimelineFilterList
name|expectedList
init|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|)
decl_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(abc,def)"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"   (   abc  ,   def  )   "
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"    abc  ,   def   "
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(abc,def)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|" !  (   abc  ,  def  )  "
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(abc)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"(abc)"
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
name|Operator
operator|.
name|OR
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"abc"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|" !  (   abc  ,  def  , xyz)  "
expr_stmt|;
name|expectedList
operator|=
operator|new
name|TimelineFilterList
argument_list|(
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"abc"
argument_list|)
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"def"
argument_list|)
argument_list|,
operator|new
name|TimelinePrefixFilter
argument_list|(
name|TimelineCompareOp
operator|.
name|NOT_EQUAL
argument_list|,
literal|"xyz"
argument_list|)
argument_list|)
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(abc,def,xyz)"
expr_stmt|;
name|verifyFilterList
argument_list|(
name|expr
argument_list|,
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
argument_list|,
name|expectedList
argument_list|)
expr_stmt|;
name|expr
operator|=
literal|"!(abc,def,xyz"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"No closing bracket. Exception should have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"!abc,def,xyz"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"NOT(!) should be followed by opening bracket. Exception should "
operator|+
literal|"have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"!abc,def,xyz"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"NOT(!) should be followed by opening bracket. Exception should "
operator|+
literal|"have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|expr
operator|=
literal|"!   r(  abc,def,xyz)"
expr_stmt|;
try|try
block|{
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
name|expr
argument_list|)
expr_stmt|;
name|fail
argument_list|(
literal|"NOT(!) should be followed by opening bracket. Exception should "
operator|+
literal|"have been thrown"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TimelineParseException
name|e
parameter_list|)
block|{}
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|null
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"     "
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"()"
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"!()"
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"(     )"
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"!(   )"
argument_list|)
argument_list|)
expr_stmt|;
name|assertNull
argument_list|(
name|TimelineReaderWebServicesUtils
operator|.
name|parseDataToRetrieve
argument_list|(
literal|"!  (   )"
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_class

end_unit

